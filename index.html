<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš´í•­ê´€ë¦¬ì‚¬ ìŒì£¼ëŸ‰ ìê°€ì§„ë‹¨ (v1.0)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ì´ ë¶€ë¶„ì„ ì¶”ê°€í•˜ì„¸ìš” -->
    <link rel="manifest" href="manifest.json">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .tab-btn.active {
            border-color: #3B82F6;
            color: #3B82F6;
            font-weight: 600;
        }
        .result-card {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <main class="flex-grow flex items-center justify-center p-4">
        <div class="w-full max-w-2xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <div class="text-center mb-6">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800">ìš´í•­ê´€ë¦¬ì‚¬ ìŒì£¼ëŸ‰ ìê°€ì§„ë‹¨ âœˆï¸</h1>
                    <p class="text-gray-500 mt-2">ì•ˆì „ ìš´í•­ì„ ìœ„í•´ ìŠ¤ìŠ¤ë¡œë¥¼ ì ê²€í•˜ì„¸ìš”.</p>
                </div>

                <!-- íƒ­ ë©”ë‰´ -->
                <div class="mb-6 border-b border-gray-200">
                    <nav class="flex -mb-px space-x-4 md:space-x-6 overflow-x-auto">
                        <button id="tab1-btn" class="tab-btn active flex-shrink-0 py-3 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">í˜„ì¬ ë†ë„ ê³„ì‚°</button>
                        <button id="tab2-btn" class="tab-btn flex-shrink-0 py-3 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">ê·¼ë¬´ ê°€ëŠ¥ ì—¬ë¶€ ì˜ˆì¸¡</button>
                        <button id="tab3-btn" class="tab-btn flex-shrink-0 py-3 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-blue-600 hover:border-blue-300">â€» ì–‘ì„± íŒì • í›„ì†ì¡°ì¹˜</button>
                    </nav>
                </div>

                <!-- íƒ­ 1: í˜„ì¬ í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ ê³„ì‚° -->
                <div id="tab1-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ì„±ë³„</label>
                            <div class="flex space-x-4">
                                <label class="flex items-center"><input type="radio" name="gender1" value="0.86" class="form-radio h-4 w-4 text-blue-600" checked><span class="ml-2 text-gray-700">ë‚¨ì„±</span></label>
                                <label class="flex items-center"><input type="radio" name="gender1" value="0.64" class="form-radio h-4 w-4 text-pink-600"><span class="ml-2 text-gray-700">ì—¬ì„±</span></label>
                            </div>
                        </div>
                        <div>
                            <label for="weight1" class="block text-sm font-medium text-gray-700 mb-1">ì²´ì¤‘ (kg)</label>
                            <input type="number" id="weight1" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="ì˜ˆ: 70">
                        </div>
                    </div>
                    <div id="alcohol-inputs-container1" class="space-y-4 mb-4"></div>
                    <button id="add-drink-btn1" class="w-full mb-6 text-sm bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition">+ ë‹¤ë¥¸ ì£¼ì¢… ì¶”ê°€í•˜ê¸° (ìµœëŒ€ 3ì¢…)</button>
                    
                    <button id="calculate-btn1" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition">ê²°ê³¼ í™•ì¸í•˜ê¸°</button>
                    <div id="error1" class="text-red-500 text-center mt-3 font-semibold h-5"></div>
                    <div id="result-container1" class="mt-5 hidden">
                        <div id="result-card1" class="result-card rounded-lg p-6">
                            <h2 class="text-xl font-bold mb-2 text-center" id="result-title1"></h2>
                            <p class="text-4xl font-bold text-center mb-4" id="bac-level1"></p>
                            <p class="text-center text-sm" id="result-message1"></p>
                        </div>
                        <div id="sober-time-info1" class="mt-4 text-center text-sm bg-yellow-100 text-yellow-800 p-3 rounded-lg hidden"><p id="sober-time1"></p></div>
                    </div>
                </div>

                <!-- íƒ­ 2: ê·¼ë¬´ ê°€ëŠ¥ ì—¬ë¶€ ì˜ˆì¸¡ -->
                <div id="tab2-content" class="hidden">
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="md:col-span-2">
                           <p class="text-sm text-gray-600 bg-gray-50 p-3 rounded-md">ì„±ë³„, ì²´ì¤‘, ìŒì£¼ ì •ë³´ëŠ” ì´ì „ íƒ­ì—ì„œ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ìŒì£¼ ì¢…ë£Œ ì‹œê°</label>
                            <div class="flex space-x-2">
                                <input type="date" id="drink-end-date" class="w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                                <select id="drink-end-hour" class="w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm"></select>
                                <select id="drink-end-minute" class="w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm"></select>
                            </div>
                        </div>
                         <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ê·¼ë¬´ ì‹œì‘ ì‹œê°</label>
                            <div class="flex space-x-2">
                                <input type="date" id="work-start-date" class="w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                                <select id="work-start-hour" class="w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm"></select>
                                <select id="work-start-minute" class="w-1/4 px-3 py-2 border border-gray-300 rounded-md shadow-sm"></select>
                            </div>
                        </div>
                    </div>

                    <button id="calculate-btn2" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition">ê·¼ë¬´ ê°€ëŠ¥ ì—¬ë¶€ ì˜ˆì¸¡í•˜ê¸°</button>
                    <div id="error2" class="text-red-500 text-center mt-3 font-semibold h-5"></div>
                    <div id="result-container2" class="mt-5 hidden">
                        <div id="result-card2" class="result-card rounded-lg p-6">
                            <h2 class="text-xl font-bold mb-2 text-center" id="result-title2"></h2>
                            <p class="text-center text-gray-600 text-sm mb-2">ê·¼ë¬´ ì‹œì‘ ì‹œì  ì˜ˆìƒ í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„</p>
                            <p class="text-4xl font-bold text-center mb-4" id="bac-level2"></p>
                            <div id="result-message2" class="text-center text-sm space-y-1"></div>
                        </div>
                    </div>
                </div>

                <!-- íƒ­ 3: í›„ì†ì¡°ì¹˜ ì•ˆë‚´ -->
                <div id="tab3-content" class="hidden">
                    <div class="space-y-6 text-gray-700">
                        <div>
                            <h3 class="text-lg font-bold text-red-600 mb-2">1) ìµœì´ˆ 1íšŒ Fail ì‹œ</h3>
                            <p class="mb-3"><span class="font-semibold">ì¡°ì¹˜:</span> ë³¸ë¶€ì¥ ê²½ê³  ë° ëŒ€ê¸° ë°œë ¹(7ì¼), ê²½ìœ„ì„œ ë³„ë„ ì§•êµ¬</p>
                            <div class="border rounded-lg p-3 bg-gray-50">
                                <p class="text-base font-semibold mb-2">ëŒ€ê¸° ë°œë ¹ ì‹œ ì—…ë¬´ ì¼ì •</p>
                                <ul class="space-y-2 text-sm">
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">Fail ë‹¹ì¼</span> <span class="col-span-2">ê·¼ë¬´ ë°°ì œ í›„ ê·€ê°€ ì¡°ì¹˜ (ìê°€ìš´ì „ ê¸ˆì§€)</span></li>
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">1ì¼ì°¨</span> <span class="col-span-2">NZ ë°©ë¬¸ ì˜ì‚¬ ë©´ë‹´, í˜ˆì•¡/ì‹¬ë¦¬ê²€ì‚¬</span></li>
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">2ì¼ì°¨</span> <span class="col-span-2">ì˜¨ë¼ì¸ êµìœ¡ ìˆ˜ê°• ë° íŒ€ì¥ ë©´ë‹´</span></li>
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">3-4ì¼ì°¨</span> <span class="col-span-2">ê´€ë ¨ ê·œì •/ì§€ì¹¨ í•™ìŠµ ë° ë³´ê³ ì„œ ì œì¶œ</span></li>
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">5ì¼ì°¨</span> <span class="col-span-2">ê·¸ë£¹ì¥/íŒ€ì¥ ë©´ë‹´ ë° ì„œì•½ì„œ ì ‘ìˆ˜</span></li>
                                    <li class="grid grid-cols-3 gap-2"><span class="font-semibold">6-7ì¼ì°¨</span> <span class="col-span-2">Day Off ë¶€ì—¬</span></li>
                                </ul>
                                <p class="text-xs text-gray-500 mt-3">* NZ ë°©ë¬¸ ë“± ì„¸ë¶€ ì¼ì •ì€ ê·¼ë¬´ ìŠ¤ì¼€ì¤„ì„ ê³ ë ¤í•˜ì—¬ íƒ„ë ¥ì ìœ¼ë¡œ ìš´ì˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-red-800 mb-2">2) ë™ì¼ì¸ ëŒ€ìƒ 2íšŒ Fail ì‹œ</h3>
                            <p><span class="font-semibold">ì¡°ì¹˜:</span> ìƒë²Œìœ„ì›íšŒ íšŒë¶€</p>
                            <ul class="list-disc list-inside text-sm mt-2 space-y-1 pl-2">
                                <li>IP í†µë³´ í›„ ë³¸ë¶€ ë˜ëŠ” ì „ì‚¬ ìƒë²Œìœ„ì›íšŒ íšŒë¶€</li>
                                <li>ë°˜ë³µ íšŸìˆ˜, ê²½ìœ„ ë“±ì„ ê³ ë ¤í•˜ì—¬ ê°œë³„ ì‹¬ì‚¬ë¥¼ í†µí•´ ì§•ê³„ ì¡°ì¹˜</li>
                                <li>ë³„ë„ ëˆ„ì  ê¸°ê°„ ì‚°ì • ì—†ìŒ</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ê·œì • ì•ˆë‚´ ì˜ì—­ ì»¨í…Œì´ë„ˆ -->
                <div id="regulation-container">
                    <div id="regulation-info-tab1" class="mt-8 p-5 bg-gray-50 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">ğŸš— ë„ë¡œêµí†µë²• ìŒì£¼ìš´ì „ ê¸ˆì§€ ê¸°ì¤€</h3>
                        <ul class="space-y-2.5 text-sm text-gray-600">
                            <li class="flex items-start">
                                <span class="text-yellow-500 font-bold mr-2">â– </span>
                                <div>
                                    <strong>ë©´í—ˆ ì •ì§€:</strong> í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ <strong class="text-yellow-600">0.03% ì´ìƒ ~ 0.08% ë¯¸ë§Œ</strong>
                                    <p class="text-xs text-gray-500 mt-1">(1ë…„ ì´í•˜ ì§•ì—­ ë˜ëŠ” 500ë§Œì› ì´í•˜ ë²Œê¸ˆ)</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-red-500 font-bold mr-2">â– </span>
                                <div>
                                    <strong>ë©´í—ˆ ì·¨ì†Œ:</strong> í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ <strong class="text-red-600">0.08% ì´ìƒ</strong>
                                    <p class="text-xs text-gray-500 mt-1">(1ë…„ ì´ìƒ 2ë…„ ì´í•˜ ì§•ì—­ ë˜ëŠ” 500ë§Œì› ì´ìƒ 1ì²œë§Œì› ì´í•˜ ë²Œê¸ˆ)</p>
                                </div>
                            </li>
                        </ul>
                         <p class="text-xs text-gray-500 mt-4">* ë³¸ ì•±ì˜ ê³„ì‚° ê²°ê³¼ëŠ” ìœ„ë“œë§ˆí¬ ê³µì‹ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì¶”ì •ì¹˜ì´ë©°, ê°œì¸ì˜ ì‹ ì²´ ì¡°ê±´ ë° ì»¨ë””ì…˜ì— ë”°ë¼ ì‹¤ì œì™€ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜ˆì¤‘ ì•Œì½”ì˜¬ë†ë„ê°€ ìµœê³ ì¹˜ì— ì´ë¥¸ í›„ <strong class="text-blue-600 font-bold">ì‹œê°„ë‹¹ ì•Œì½”ì˜¬ ë¶„í•´ ê°’ì€ ê°œì¸ì— ë”°ë¼ 0.008%~0.030% ë‹¤ë¥¼ ìˆ˜ ìˆì–´</strong> í‰ê· ì ìœ¼ë¡œ ì‹œê°„ë‹¹ 0.015%ì”© ê°ì†Œí•˜ëŠ” ê²ƒìœ¼ë¡œ ì‚°ì •í•˜ì˜€ìœ¼ë©°, ê°œì¸ë³„ ì•Œì½”ì˜¬ ë¶„í•´ëŠ¥ë ¥ì— ë”°ë¼ í¸ì°¨ê°€ í´ ìˆ˜ ìˆì–´ APPì—ì„œ ì‚°ì¶œëœ ê°’ì€ ONLY <strong class="text-red-600 font-bold">ì°¸ê³ ìš©</strong>ìœ¼ë¡œë§Œ í™œìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
                    </div>

                    <div id="regulation-info-tab2" class="hidden mt-8 p-5 bg-gray-50 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">âš ï¸ ìš´í•­ê´€ë¦¬ì‚¬ ìŒì£¼ ê´€ë ¨ ì£¼ìš” ê·œì •</h3>
                        <ul class="space-y-2.5 text-sm text-gray-600">
                            <li class="flex items-start">
                                <span class="text-red-500 font-bold mr-2">â– </span>
                                <div>
                                    <strong>ê·¼ë¬´ ë¶ˆê°€ ì¡°ê±´ (ì•„ë˜ ì¤‘ í•˜ë‚˜ë¼ë„ í•´ë‹¹ ì‹œ):</strong>
                                    <ul class="list-disc list-inside mt-1 space-y-1">
                                        <li>ì•Œì½”ì˜¬ ìŒë£Œ ë³µìš© í›„ <strong class="text-red-600">12ì‹œê°„</strong>ì´ ê²½ê³¼í•˜ì§€ ì•Šì€ ê²½ìš°</li>
                                        <li>í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ <strong class="text-red-600">0.02%</strong> ì´ìƒì¸ ê²½ìš°</li>
                                        <li>ì•Œì½”ì˜¬ì˜ ì˜í–¥ í•˜ì— ìˆë‹¤ê³  íŒë‹¨ë  ë•Œ</li>
                                        <li>ë‹¹êµ­ì˜ ìŒì£¼ ì¸¡ì •ì„ ê±°ë¶€í•  ê²½ìš°</li>
                                    </ul>
                                </div>
                            </li>
                            <li class="flex items-start"><span class="text-blue-500 font-bold mr-2">â– </span><div><strong>í–‰ì • ì²˜ë¶„ (ë†ë„ë³„):</strong>
                                <ul class="list-disc list-inside ml-5 mt-1 space-y-1">
                                    <li>0.02% ~ 0.06%: ìê²©ì¦ëª… íš¨ë ¥ì •ì§€ 60ì¼</li>
                                    <li>0.06% ~ 0.09%: ìê²©ì¦ëª… íš¨ë ¥ì •ì§€ 120ì¼</li>
                                    <li>0.09% ì´ìƒ: ìê²©ì¦ëª… ì·¨ì†Œ</li>
                                </ul>
                            </li>
                             <li class="flex items-start"><span class="text-gray-500 font-bold mr-2">â– </span><div><strong>ì—„ê²© ê¸ˆì§€ ì‚¬í•­:</strong> <strong class="text-red-600"> ê·¼ë¬´/í›ˆë ¨ ì¤‘ ìŒì£¼, ë™ë£Œì˜ ê·¼ë¬´ ì¤‘ ìŒì£¼ ë¬µì¸, í…ŒìŠ¤íŠ¸ ë¶ˆì‘ ë“±</strong></div></li>
                        </ul>
                        <p class="text-xs text-gray-500 mt-4">* ë³¸ ì•±ì˜ ê³„ì‚° ê²°ê³¼ëŠ” ìœ„ë“œë§ˆí¬ ê³µì‹ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì¶”ì •ì¹˜ì´ë©°, ê°œì¸ì˜ ì‹ ì²´ ì¡°ê±´ ë° ì»¨ë””ì…˜ì— ë”°ë¼ ì‹¤ì œì™€ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜ˆì¤‘ ì•Œì½”ì˜¬ë†ë„ê°€ ìµœê³ ì¹˜ì— ì´ë¥¸ í›„ <strong class="text-blue-600 font-bold">ì‹œê°„ë‹¹ ì•Œì½”ì˜¬ ë¶„í•´ ê°’ì€ ê°œì¸ì— ë”°ë¼ 0.008%~0.030% ë‹¤ë¥¼ ìˆ˜ ìˆì–´</strong> í‰ê· ì ìœ¼ë¡œ ì‹œê°„ë‹¹ 0.015%ì”© ê°ì†Œí•˜ëŠ” ê²ƒìœ¼ë¡œ ì‚°ì •í•˜ì˜€ìœ¼ë©°, <strong class="text-red-600 font-bold">ì°¸ê³ ìš©</strong>ìœ¼ë¡œë§Œ í™œìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="text-center py-4">
        <p class="text-gray-600 text-lg font-semibold">Operations & Customer Center</p>
        <p class="text-gray-400 text-xs mt-1">Â© 2025 KE SOP INSA MANAGER. All rights reserved.</p>
    </footer>

    <script>
        // --- ì´ˆê¸°í™” ë° ê³µí†µ ë¡œì§ ---
        const unitMapping = {
            '17': { 'ë³‘': 360, 'ë°˜ë³‘': 180, 'ì”': 60, 'ml': 1 }, // ì†Œì£¼
            '5': { 'ë³‘': 330, 'ì”(500cc)': 500, 'ml': 1 }, // ë§¥ì£¼ 500 cc
            '14': { 'ë³‘': 750, 'ì”': 150, 'ml': 1 }, // ì™€ì¸
            '40': { 'ì”(1oz)': 30, 'ml': 1 }, // ìœ„ìŠ¤í‚¤
            '6': { 'ë³‘': 750, 'ml': 1 }, // ë§‰ê±¸ë¦¬
            'custom': { 'ml': 1 }
        };

        document.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            setupAddDrinkButton('1');
            populateTimeSelects();
            addAlcoholInput(1);
            setupCalculation('1');
            setupCalculation('2');
        });

        function setupTabs() {
            const tabs = {
                btn1: document.getElementById('tab1-btn'),
                btn2: document.getElementById('tab2-btn'),
                btn3: document.getElementById('tab3-btn'),
                content1: document.getElementById('tab1-content'),
                content2: document.getElementById('tab2-content'),
                content3: document.getElementById('tab3-content'),
                regInfoContainer: document.getElementById('regulation-container'),
                regInfo1: document.getElementById('regulation-info-tab1'),
                regInfo2: document.getElementById('regulation-info-tab2'),
            };
            tabs.btn1.addEventListener('click', () => switchTab('tab1', tabs));
            tabs.btn2.addEventListener('click', () => switchTab('tab2', tabs));
            tabs.btn3.addEventListener('click', () => switchTab('tab3', tabs));
        }

        function switchTab(tabName, tabs) {
            const tabContents = [tabs.content1, tabs.content2, tabs.content3];
            const tabButtons = [tabs.btn1, tabs.btn2, tabs.btn3];
            
            tabContents.forEach(content => content.classList.add('hidden'));
            tabButtons.forEach(button => button.classList.remove('active'));

            if (tabName === 'tab1') {
                tabs.content1.classList.remove('hidden');
                tabs.btn1.classList.add('active');
                tabs.regInfoContainer.classList.remove('hidden');
                tabs.regInfo1.classList.remove('hidden');
                tabs.regInfo2.classList.add('hidden');
            } else if (tabName === 'tab2') {
                tabs.content2.classList.remove('hidden');
                tabs.btn2.classList.add('active');
                tabs.regInfoContainer.classList.remove('hidden');
                tabs.regInfo1.classList.add('hidden');
                tabs.regInfo2.classList.remove('hidden');
            } else if (tabName === 'tab3') {
                tabs.content3.classList.remove('hidden');
                tabs.btn3.classList.add('active');
                tabs.regInfoContainer.classList.add('hidden');
            }
        }

        function populateTimeSelects() {
            const hourSelects = [document.getElementById('drink-end-hour'), document.getElementById('work-start-hour')];
            const minuteSelects = [document.getElementById('drink-end-minute'), document.getElementById('work-start-minute')];

            for (let i = 0; i < 24; i++) {
                const value = i.toString().padStart(2, '0');
                hourSelects.forEach(sel => sel.add(new Option(value, value)));
            }
            for (let i = 0; i < 60; i++) {
                const value = i.toString().padStart(2, '0');
                minuteSelects.forEach(sel => sel.add(new Option(value, value)));
            }
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            const yyyyMMdd = now.toISOString().slice(0, 10);
            document.getElementById('drink-end-date').value = yyyyMMdd;
            document.getElementById('work-start-date').value = yyyyMMdd;
        }

        // --- ì£¼ì¢… ì¶”ê°€ ë¡œì§ ---
        let drinkCount = { '1': 0 };

        function setupAddDrinkButton(tabNum) {
            document.getElementById(`add-drink-btn${tabNum}`).addEventListener('click', () => addAlcoholInput(tabNum));
        }

        function addAlcoholInput(tabNum) {
            if (drinkCount[tabNum] >= 3) return;
            drinkCount[tabNum]++;

            const container = document.getElementById(`alcohol-inputs-container${tabNum}`);
            
            const wrapper = document.createElement('div');
            wrapper.className = 'alcohol-input-group p-3 border border-gray-200 rounded-lg';
            wrapper.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <p class="text-sm font-semibold text-gray-600">ì£¼ì¢… #${drinkCount[tabNum]}</p>
                    ${drinkCount[tabNum] > 1 ? `<button class="remove-drink-btn text-red-500 text-xs font-bold">ì‚­ì œ</button>` : ''}
                </div>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-2">
                    <div>
                        <label class="block text-xs font-medium text-gray-600">ì£¼ì¢…</label>
                        <select class="alcohol-type w-full text-sm px-2 py-1 border border-gray-300 rounded-md">
                            <option value="17">ì†Œì£¼ (17%)</option><option value="5">ë§¥ì£¼ (5%)</option><option value="14">ì™€ì¸ (14%)</option><option value="40">ìœ„ìŠ¤í‚¤ (40%)</option><option value="6">ë§‰ê±¸ë¦¬ (6%)</option><option value="custom">ì§ì ‘ ì…ë ¥</option>
                        </select>
                    </div>
                    <div class="custom-alcohol-div hidden">
                        <label class="block text-xs font-medium text-gray-600">ë„ìˆ˜(%)</label>
                        <input type="number" class="custom-alcohol-input w-full text-sm px-2 py-1 border border-gray-300 rounded-md" placeholder="ì˜ˆ: 17">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-600">ë‹¨ìœ„</label>
                        <select class="unit-select w-full text-sm px-2 py-1 border border-gray-300 rounded-md"></select>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-600">ìŒì£¼ëŸ‰</label>
                        <input type="number" class="amount-input w-full text-sm px-2 py-1 border border-gray-300 rounded-md" placeholder="ì˜ˆ: 1">
                    </div>
                </div>
            `;
            container.appendChild(wrapper);
            
            const alcoholTypeSelect = wrapper.querySelector('.alcohol-type');
            const unitSelect = wrapper.querySelector('.unit-select');

            function updateUnitOptions() {
                const selectedType = alcoholTypeSelect.value;
                unitSelect.innerHTML = '';
                const units = unitMapping[selectedType] || { 'ml': 1 };
                for (const unit in units) {
                    unitSelect.add(new Option(unit, unit));
                }
                wrapper.querySelector('.custom-alcohol-div').classList.toggle('hidden', selectedType !== 'custom');
            }

            alcoholTypeSelect.addEventListener('change', updateUnitOptions);
            updateUnitOptions(); // ì´ˆê¸° ì˜µì…˜ ì„¤ì •

            const removeBtn = wrapper.querySelector('.remove-drink-btn');
            if (removeBtn) {
                removeBtn.addEventListener('click', (e) => {
                    e.target.closest('.alcohol-input-group').remove();
                    drinkCount[tabNum]--;
                    document.getElementById(`add-drink-btn${tabNum}`).style.display = 'block';
                    container.querySelectorAll('.alcohol-input-group').forEach((group, index) => {
                        group.querySelector('p').textContent = `ì£¼ì¢… #${index + 1}`;
                    });
                });
            }

            if (drinkCount[tabNum] >= 3) {
                document.getElementById(`add-drink-btn${tabNum}`).style.display = 'none';
            }
        }
        
        // --- ê³„ì‚° ë¡œì§ ---
        function setupCalculation(tabNum) {
            document.getElementById(`calculate-btn${tabNum}`).addEventListener('click', () => {
                const errorDiv = document.getElementById(`error${tabNum}`);
                errorDiv.textContent = '';
                document.getElementById(`result-container${tabNum}`).classList.add('hidden');

                const inputs = getInputs(tabNum);
                if (!inputs) return;

                const peakBac = calculatePeakBAC(inputs.genderCoeff, inputs.weight, inputs.totalPureAlcohol);
                
                if (tabNum === '1') {
                    displayResult1(peakBac);
                } else {
                    const drinkEndTime = inputs.drinkEndTime;
                    const workStartTime = inputs.workStartTime;
                    
                    const totalElapsedHours = (workStartTime - drinkEndTime) / (1000 * 60 * 60);
                    const risingPhaseHours = 1.5; // 90ë¶„
                    const eliminationHours = Math.max(0, totalElapsedHours - risingPhaseHours);
                    const eliminatedBac = eliminationHours * 0.015; // ì‹œê°„ë‹¹ 0.015% ê°ì†Œ
                    const estimatedBac = Math.max(0, peakBac - eliminatedBac);

                    displayResult2(estimatedBac, totalElapsedHours);
                }
            });
        }
        
        function getInputs(tabNum) {
            const errorDiv = document.getElementById(`error${tabNum}`);
            const sourceTabNumForInfo = tabNum === '2' ? '1' : tabNum;

            const genderEl = document.querySelector(`input[name="gender${sourceTabNumForInfo}"]:checked`);
            const weightEl = document.getElementById(`weight${sourceTabNumForInfo}`);

            if (!genderEl || !weightEl) {
                errorDiv.textContent = 'ê¸°ë³¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return null;
            }

            const genderCoeff = parseFloat(genderEl.value);
            const weight = parseFloat(weightEl.value);

            if (isNaN(weight) || weight <= 0) {
                errorDiv.textContent = 'ì˜¬ë°”ë¥¸ ì²´ì¤‘ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return null;
            }

            const inputGroups = document.querySelectorAll(`#alcohol-inputs-container1 .alcohol-input-group`);
            
            if (inputGroups.length === 0) {
                 (tabNum === '2' ? document.getElementById('error2') : errorDiv).textContent = 'í•˜ë‚˜ ì´ìƒì˜ ì£¼ì¢…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return null;
            }

            let totalPureAlcohol = 0;
            let hasInputError = false;
            
            inputGroups.forEach((group) => {
                const quantity = parseFloat(group.querySelector('.amount-input').value);
                const alcoholTypeSelect = group.querySelector('.alcohol-type');
                const unit = group.querySelector('.unit-select').value;
                let alcoholPercent = parseFloat(alcoholTypeSelect.value);

                if (alcoholTypeSelect.value === 'custom') {
                    alcoholPercent = parseFloat(group.querySelector('.custom-alcohol-input').value);
                }

                if (isNaN(quantity) || quantity <= 0 || isNaN(alcoholPercent) || alcoholPercent <= 0) {
                    hasInputError = true;
                } else {
                    const mlPerUnit = unitMapping[alcoholTypeSelect.value][unit];
                    const totalMl = quantity * mlPerUnit;
                    totalPureAlcohol += totalMl * (alcoholPercent / 100) * 0.7894;
                }
            });
            
            if (hasInputError) {
                (tabNum === '2' ? document.getElementById('error2') : errorDiv).textContent = 'ëª¨ë“  ì£¼ì¢…ì˜ ë„ìˆ˜ì™€ ìŒì£¼ëŸ‰ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return null;
            }
            
            if (tabNum === '2') {
                const drinkDate = document.getElementById('drink-end-date').value;
                const drinkHour = document.getElementById('drink-end-hour').value;
                const drinkMinute = document.getElementById('drink-end-minute').value;
                const workDate = document.getElementById('work-start-date').value;
                const workHour = document.getElementById('work-start-hour').value;
                const workMinute = document.getElementById('work-start-minute').value;

                if (!drinkDate || !workDate) {
                    errorDiv.textContent = 'ìŒì£¼ ì¢…ë£Œ ë° ê·¼ë¬´ ì‹œì‘ ë‚ ì§œ/ì‹œê°„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                    return null;
                }
                const drinkEndTime = new Date(`${drinkDate}T${drinkHour}:${drinkMinute}`);
                const workStartTime = new Date(`${workDate}T${workHour}:${workMinute}`);

                if (drinkEndTime >= workStartTime) {
                    errorDiv.textContent = 'ìŒì£¼ ì¢…ë£Œ ì‹œê°ì€ ê·¼ë¬´ ì‹œì‘ ì‹œê°ë³´ë‹¤ ë¹¨ë¼ì•¼ í•©ë‹ˆë‹¤.';
                    return null;
                }
                return { genderCoeff, weight, totalPureAlcohol, drinkEndTime, workStartTime };
            }
            
            return { genderCoeff, weight, totalPureAlcohol };
        }

        function calculatePeakBAC(genderCoeff, weight, totalPureAlcohol) {
            if (totalPureAlcohol === 0) return 0;
            return (totalPureAlcohol * 0.7) / (weight * genderCoeff * 10);
        }

        // --- ê²°ê³¼ í‘œì‹œ ë¡œì§ ---
        function displayResult1(bac) {
            const form = {
                container: document.getElementById('result-container1'),
                card: document.getElementById('result-card1'),
                title: document.getElementById('result-title1'),
                level: document.getElementById('bac-level1'),
                message: document.getElementById('result-message1'),
                soberInfo: document.getElementById('sober-time-info1'),
                soberTime: document.getElementById('sober-time1'),
            };
            form.container.classList.remove('hidden');
            form.level.textContent = `${bac.toFixed(4)}%`;

            const workLimit = 0.02;
            const duiSuspensionLimit = 0.03;
            const duiRevocationLimit = 0.08;

            let titleText = '';
            let messageText = '';
            let cardClass = '';

            if (bac >= workLimit) {
                
                if (bac >= duiRevocationLimit) {
                    titleText = 'ğŸš¨ ë©´í—ˆ ì·¨ì†Œ ë° ì—…ë¬´ ë¶ˆê°€';
                    messageText = `ìš´í•­ê´€ë¦¬ì‚¬ ê¸°ì¤€(0.02%) ì´ˆê³¼ ë° ë„ë¡œêµí†µë²•ìƒ <strong class="font-bold">ë©´í—ˆ ì·¨ì†Œ</strong> ìˆ˜ì¤€ì…ë‹ˆë‹¤.`;
                } else if (bac >= duiSuspensionLimit) {
                    titleText = 'âš ï¸ ë©´í—ˆ ì •ì§€ ë° ì—…ë¬´ ë¶ˆê°€';
                    messageText = `ìš´í•­ê´€ë¦¬ì‚¬ ê¸°ì¤€(0.02%) ì´ˆê³¼ ë° ë„ë¡œêµí†µë²•ìƒ <strong class="font-bold">ë©´í—ˆ ì •ì§€</strong> ìˆ˜ì¤€ì…ë‹ˆë‹¤.`;
                } else {
                    titleText = 'ğŸš¨ ì—…ë¬´ ë¶ˆê°€ (ê¸°ì¤€ì¹˜ ì´ˆê³¼)';
                    messageText = `ìš´í•­ê´€ë¦¬ì‚¬ ìŒì£¼ ë‹¨ì† ê¸°ì¤€ì¸ ${workLimit}%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`;
                }
                cardClass = 'result-card rounded-lg p-6 bg-red-100 text-red-800';

                // ìƒìŠ¹ê¸° 90ë¶„(1.5ì‹œê°„)ì„ í¬í•¨í•œ í•´ì†Œ ì‹œê°„ ê³„ì‚°
                const timeToDrop = (bac - workLimit) / 0.015; // ê°ì†Œì— ê±¸ë¦¬ëŠ” ì‹œê°„
                const totalTimeToSoberInHours = timeToDrop + 1.5; // ìƒìŠ¹ê¸° 90ë¶„ ì¶”ê°€
                
                const totalMinutes = Math.round(totalTimeToSoberInHours * 60);
                const hours = Math.floor(totalMinutes / 60);
                const minutes = totalMinutes % 60;

                form.soberTime.textContent = `ì—…ë¬´ ê°€ëŠ¥ ê¸°ì¤€(${workLimit}%)ê¹Œì§€ ìµœì†Œ ${hours}ì‹œê°„ ${minutes}ë¶„ ì´ìƒ ì†Œìš”ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤(ìƒìŠ¹ê¸° 90ë¶„ í¬í•¨).`;
                form.soberInfo.classList.remove('hidden');

            } else {
                titleText = 'âœ… ì—…ë¬´ ê°€ëŠ¥';
                cardClass = 'result-card rounded-lg p-6 bg-green-100 text-green-800';
                
                if (bac > 0) {
                     messageText = `ìš´í•­ê´€ë¦¬ì‚¬ ê¸°ì¤€(${workLimit}%) ë¯¸ë§Œì…ë‹ˆë‹¤. <strong class="text-red-600 font-bold">ë‹¨, ìŒì£¼ í›„ì—ëŠ” ì ˆëŒ€ ê·¼ë¬´/ìš´ì „í•˜ì§€ ë§ˆì‹­ì‹œì˜¤.</strong>`;
                } else {
                     messageText = `ì˜ˆìƒë˜ëŠ” í˜ˆì¤‘ ì•Œì½”ì˜¬ì´ ì—†ìŠµë‹ˆë‹¤.`;
                }
                form.soberInfo.classList.add('hidden');
            }

            form.title.textContent = titleText;
            form.card.className = cardClass;
            form.message.innerHTML = messageText;
        }

        function displayResult2(bac, elapsedHours) {
            const form = {
                container: document.getElementById('result-container2'),
                card: document.getElementById('result-card2'),
                title: document.getElementById('result-title2'),
                level: document.getElementById('bac-level2'),
                message: document.getElementById('result-message2'),
            };
            form.container.classList.remove('hidden');
            form.level.textContent = `${bac.toFixed(4)}%`;

            const isTimeViolation = elapsedHours < 12;
            const isBacViolation = bac >= 0.02;
            let title = '';
            let cardClass = '';
            let messages = '';

            if (isTimeViolation || isBacViolation) {
                title = 'ğŸš¨ ê·¼ë¬´ ë¶ˆê°€' + (isTimeViolation && isBacViolation ? ' (ë³µìˆ˜ ê·œì • ìœ„ë°˜)' : isTimeViolation ? ' (12ì‹œê°„ ê·œì • ìœ„ë°˜)' : ' (ë†ë„ ê¸°ì¤€ ì´ˆê³¼)');
                cardClass = 'result-card rounded-lg p-6 bg-red-100 text-red-800';
            } else {
                title = 'âœ… ê·¼ë¬´ ê°€ëŠ¥';
                cardClass = 'result-card rounded-lg p-6 bg-green-100 text-green-800';
            }
            
            form.title.textContent = title;
            form.card.className = cardClass;

            messages += isTimeViolation ? `<p class="text-red-600">âŒ ìŒì£¼ í›„ 12ì‹œê°„ ê²½ê³¼ ê·œì • ìœ„ë°˜ (ê²½ê³¼ ì‹œê°„: ${Math.floor(elapsedHours)}ì‹œê°„ ${Math.round((elapsedHours % 1) * 60)}ë¶„)</p>` : `<p class="text-green-600">âœ”ï¸ ìŒì£¼ í›„ 12ì‹œê°„ ê²½ê³¼ ê·œì • ì¶©ì¡±</p>`;
            messages += isBacViolation ? `<p class="text-red-600">âŒ í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ 0.02% ì´ìƒ</p>` : `<p class="text-green-600">âœ”ï¸ í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ 0.02% ë¯¸ë§Œ</p>`;
            form.message.innerHTML = messages;
        }
    </script>
<!-- ì´ ë¶€ë¶„ì„ ì¶”ê°€í•˜ì„¸ìš” -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./service-worker.js').then(registration => {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, err => {
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
</body>
</html>




